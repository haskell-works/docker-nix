machine:
  services:
    - docker

dependencies:
  cache_directories:
  environment:
    DOCKER_BIN: ~/bin
  pre:
    - docker login -u $DOCKER_USER -p $DOCKER_PASS -e $DOCKER_EMAIL
  override:
    - docker build -t "haskellworks/docker-nix:$CIRCLE_BRANCH" .

test:
  override:
    - echo "No tests"

deployment:
  development:
    branch: /.*/
    commands:
      - docker push "haskellworks/docker-nix:$CIRCLE_BRANCH"
